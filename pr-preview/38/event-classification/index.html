
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://paolino.github.io/kel-circle/event-classification/">
      
      
        <link rel="prev" href="../base-semantics/">
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Event Classification - kel-circle</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#event-classification" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="kel-circle" class="md-header__button md-logo" aria-label="kel-circle" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            kel-circle
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Event Classification
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/paolino/kel-circle" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    paolino/kel-circle
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="kel-circle" class="md-nav__button md-logo" aria-label="kel-circle" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    kel-circle
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/paolino/kel-circle" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    paolino/kel-circle
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Roadmap
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../base-semantics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base Semantics
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Event Classification
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Classification
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-three-event-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        The three event classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The three event classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-straight-decision" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Straight decision
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-proposal" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Proposal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-response" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Response
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proposal-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proposal lifecycle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Proposal lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#opening" class="md-nav__link">
    <span class="md-ellipsis">
      
        Opening
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collecting-responses" class="md-nav__link">
    <span class="md-ellipsis">
      
        Collecting responses
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Resolution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server-emitted-decisions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Server-emitted decisions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Response validation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeout-obligation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Timeout obligation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#admin-majority-as-a-threshold-gate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Admin majority as a threshold gate
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#all-event-classes-contribute-to-the-fold" class="md-nav__link">
    <span class="md-ellipsis">
      
        All event classes contribute to the fold
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#application-parameterization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Application parameterization
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-three-event-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        The three event classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The three event classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-straight-decision" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Straight decision
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-proposal" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Proposal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-response" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Response
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proposal-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        Proposal lifecycle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Proposal lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#opening" class="md-nav__link">
    <span class="md-ellipsis">
      
        Opening
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collecting-responses" class="md-nav__link">
    <span class="md-ellipsis">
      
        Collecting responses
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Resolution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server-emitted-decisions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Server-emitted decisions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Response validation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeout-obligation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Timeout obligation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#admin-majority-as-a-threshold-gate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Admin majority as a threshold gate
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#all-event-classes-contribute-to-the-fold" class="md-nav__link">
    <span class="md-ellipsis">
      
        All event classes contribute to the fold
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#application-parameterization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Application parameterization
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="event-classification">Event Classification</h1>
<p>The global sequence contains events of three classes. The classes
are fixed by the protocol; the <strong>content</strong> within each class is
parameterized by the application.</p>
<h2 id="the-three-event-classes">The three event classes</h2>
<h3 id="1-straight-decision">1. Straight decision</h3>
<p>A straight decision is an event that, as long as it passes both
the base gate and the application gate, is accepted and immediately
changes the fold state. No coordination machinery is involved — no
proposal, no voting, no timeout.</p>
<p>The two-level gate for straight decisions:</p>
<div class="highlight"><pre><span></span><code>baseGate        :: CircleState -&gt; MemberId -&gt; MemberId -&gt; BaseDecision -&gt; Bool
applicationGate :: AppFoldState -&gt; BaseDecision -&gt; Bool
</code></pre></div>
<p>If both gates return true, the decision is sequenced and the fold
advances. If either returns false, the event is rejected.</p>
<p>Straight decisions are the simplest path: a member submits, the
server validates through the two-level gate, the fold updates.</p>
<h3 id="2-proposal">2. Proposal</h3>
<p>A proposal is an event that initiates a coordination round. It
contributes to the fold like any other sequenced event, and also
opens a window for responses that eventually resolves into a
decision (positive or negative).</p>
<p>A proposal carries:</p>
<ul>
<li>
<p><strong>Mandatory timeout</strong> — bounded by the server's configured
  maximum. If no positive resolution occurs before the timeout,
  the sequencer emits a <strong>negative decision</strong> automatically.</p>
</li>
<li>
<p><strong>Optional threshold gate</strong> — a function over collected
  responses:</p>
<div class="highlight"><pre><span></span><code>thresholdGate :: [ResponseContent] -&gt; Bool
</code></pre></div>
<p>When the threshold is met, the sequencer emits a <strong>positive
decision</strong> automatically.</p>
</li>
</ul>
<h3 id="3-response">3. Response</h3>
<p>A response is an event submitted by a member in reaction to an
open proposal. Its content is application-defined — the protocol
does not prescribe what a response looks like, only that it
references a specific proposal.</p>
<p>Responses contribute to the fold like any other sequenced
event. They also accumulate for lifecycle tracking until:</p>
<ul>
<li>The threshold gate fires (if present), or</li>
<li>The proposer closes the proposal, or</li>
<li>The timeout expires</li>
</ul>
<p><strong>Lean predicates:</strong> <code>EventClass</code>, <code>event_trichotomy</code>,
<code>decision_not_proposal</code>, <code>decision_not_response</code>,
<code>proposal_not_response</code>,
<code>Resolution</code>, <code>ProposalStatus</code>, <code>TrackedProposal</code>,
<code>ProposalRegistry</code></p>
<h2 id="proposal-lifecycle">Proposal lifecycle</h2>
<pre class="mermaid"><code>stateDiagram-v2
    [*] --&gt; Open: member submits proposal
    Open --&gt; Resolved: threshold reached
    Open --&gt; Resolved: proposer closes positively
    Open --&gt; Resolved: proposer closes negatively
    Open --&gt; Expired: timeout reached
    Resolved --&gt; [*]: server emits decision
    Expired --&gt; [*]: server emits negative decision</code></pre>
<h3 id="opening">Opening</h3>
<p>A member submits a proposal event. The sequencer validates it
(base gate + application gate), assigns a sequence number, and
records it as open with its timeout deadline.</p>
<h3 id="collecting-responses">Collecting responses</h3>
<p>Members submit response events referencing the proposal. Each
response is sequenced and associated with the open proposal.</p>
<h3 id="resolution">Resolution</h3>
<p>A proposal resolves in one of four ways:</p>
<ol>
<li>
<p><strong>Threshold reached</strong> — if the proposal has a threshold gate and
   enough valid responses accumulate to satisfy it, the sequencer
   emits a positive decision. The decision carries the responses
   that satisfied the threshold.</p>
</li>
<li>
<p><strong>Proposer closes positively</strong> — the original proposer can close
   their proposal at any time with a positive outcome. They must
   include a subset of the collected responses. The sequencer emits
   a decision carrying those responses.</p>
</li>
<li>
<p><strong>Proposer closes negatively</strong> — the proposer cancels the
   proposal. The sequencer emits a negative decision.</p>
</li>
<li>
<p><strong>Timeout</strong> — the deadline passes without resolution. The
   sequencer emits a negative decision automatically. This is
   guaranteed because the timeout is mandatory.</p>
</li>
</ol>
<h3 id="server-emitted-decisions">Server-emitted decisions</h3>
<p>In cases 1, 3, and 4, the <strong>sequencer itself</strong> emits the decision
event. This is why the server is a circle member with its own KEL
— it signs these decision events with its own key.</p>
<p>The server-emitted decision is a regular event in the global
sequence. Clients can verify its signature against the server's
KEL just like any other event.</p>
<h3 id="response-validation">Response validation</h3>
<p>A member can respond to an open proposal at most once. The
protocol tracks respondents per proposal and rejects duplicate
responses. Only open proposals accept responses — once resolved,
no further responses are accepted.</p>
<h3 id="timeout-obligation">Timeout obligation</h3>
<p>Every proposal has a mandatory deadline. The sequencer must
resolve any open proposal whose deadline has passed. This is a
<strong>liveness obligation</strong> on the sequencer: as long as the sequencer
is running, no proposal remains open past its deadline. Resolved
proposals trivially satisfy this obligation.</p>
<h3 id="admin-majority-as-a-threshold-gate">Admin majority as a threshold gate</h3>
<p>Admin role changes (promote/demote) use the proposal mechanism
with <strong>admin majority</strong> as the threshold gate. The threshold
checks whether the number of admin respondents meets the majority
threshold for the current circle. A single admin trivially meets
majority with their own response, which is why a lone admin can
demote themselves.</p>
<p><strong>Lean predicates:</strong> <code>openProposal</code>, <code>addResponse</code>,
<code>resolveProposal</code>, <code>findProposal</code>,
<code>open_proposal_is_open</code>, <code>open_proposal_no_responses</code>,
<code>resolve_resolved_noop</code>, <code>resolution_dichotomy</code>,
<code>threshold_is_positive</code>, <code>proposer_positive_is_positive</code>,
<code>proposer_negative_is_negative</code>, <code>timeout_is_negative</code>,
<code>timeoutObligation</code>, <code>resolved_satisfies_obligation</code>,
<code>adminMajorityMet</code>, <code>single_admin_majority_self</code>,
<code>hasNotResponded</code>, <code>canRespond</code>,
<code>fresh_proposal_accepts_response</code></p>
<h2 id="all-event-classes-contribute-to-the-fold">All event classes contribute to the fold</h2>
<p>All three event classes — decisions, proposals, and responses —
advance the fold state when sequenced. The fold has two layers:</p>
<ul>
<li>
<p><strong>Base fold</strong> — extracts membership and role information from all
  event types. This layer is fixed by the protocol. The base gate
  uses only the base fold to check membership, roles, and freshness.</p>
</li>
<li>
<p><strong>Application fold</strong> — accumulates domain-specific state from all
  event types. This layer is pluggable. The application gate uses
  the full fold (base + application) to validate domain rules.</p>
</li>
</ul>
<p>The event classification still matters for the proposal lifecycle
(proposals open coordination rounds, responses accumulate within
them, decisions resolve them) but all three classes feed into the
fold. A future optimization may allow skipping fully resolved
proposals during fold replay, but the base model treats every
sequenced event as a fold input.</p>
<p>This means:</p>
<ul>
<li>No separate L1/L2 event logs</li>
<li>One global sequence for everything</li>
<li>Every sequenced event advances the fold</li>
<li>Full audit trail preserved in the sequence</li>
</ul>
<p><strong>Lean predicates:</strong> <code>foldAll</code>, <code>fold_empty</code>, <code>fold_append</code>,
<code>TwoLayerState</code>, <code>twoLayerFold</code>, <code>two_layer_fold_empty</code>,
<code>two_layer_fold_append</code></p>
<h2 id="application-parameterization">Application parameterization</h2>
<p>The protocol fixes the <strong>event classes</strong> (decision, proposal,
response) but leaves the <strong>content</strong> to the application:</p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Protocol (fixed)</th>
<th>Application (parameterized)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Event classes</td>
<td>decision, proposal, response</td>
<td>—</td>
</tr>
<tr>
<td>Membership</td>
<td>base-layer, extracted from fold</td>
<td>—</td>
</tr>
<tr>
<td>Admin roles</td>
<td>base-layer</td>
<td>—</td>
</tr>
<tr>
<td>Decision content</td>
<td>—</td>
<td>domain-specific payload</td>
</tr>
<tr>
<td>Proposal content</td>
<td>timeout, threshold gate shape</td>
<td>domain-specific payload</td>
</tr>
<tr>
<td>Response content</td>
<td>—</td>
<td>domain-specific payload</td>
</tr>
<tr>
<td>Base gate</td>
<td>membership, freshness, sequencer protection</td>
<td>—</td>
</tr>
<tr>
<td>Application gate</td>
<td>—</td>
<td>domain-specific validation</td>
</tr>
<tr>
<td>Threshold gate</td>
<td>—</td>
<td>application-defined function</td>
</tr>
</tbody>
</table>
<p>The application supplies:</p>
<ul>
<li>Types for decision, proposal, and response content</li>
<li>An application gate function (for base decisions:
  <code>AppFoldState -&gt; BaseDecision -&gt; Bool</code>)</li>
<li>An optional threshold gate function per proposal
  (<code>[ResponseContent] -&gt; Bool</code>)</li>
<li>A fold function that applies events to state</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.sections", "content.code.copy"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../javascripts/mermaid.mjs" type="module"></script>
      
    
  </body>
</html>